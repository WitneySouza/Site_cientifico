<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecossistemas de Florian√≥polis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals & Nature Tones -->
    <!-- Application Structure Plan: A tab-based single-page application (SPA) was chosen to provide a clear, user-guided exploration of Florian√≥polis's ecosystems. The structure begins with a "Vis√£o Geral" (Overview) to provide immediate high-level context and quantitative data. Users can then navigate thematically between "Mata Atl√¢ntica," "Restinga," and "Manguezal" for detailed information. A final, crucial section, "Amea√ßas e Conserva√ß√£o," synthesizes the challenges and solutions across all ecosystems. This tabbed structure is highly intuitive, prevents cognitive overload by presenting one topic at a time, and allows users to compare ecosystems easily by switching between views. The flow is logical: from general overview to specific details, and finally to the overarching issue of conservation. -->
    <!-- Visualization & Content Choices: 
        - Report Info: ~40% of the island is a Permanent Preservation Area (APP). -> Goal: Show proportion. -> Viz: Donut Chart in "Vis√£o Geral". -> Interaction: Hover tooltips. -> Justification: Excellent for instantly communicating a simple part-to-whole relationship, setting the stage for the importance of conservation. -> Library: Chart.js.
        - Report Info: Mangroves are nurseries for marine life and vital for fisheries (>95% of seafood depends on them). -> Goal: Emphasize the immense economic and ecological importance of mangroves. -> Viz: Horizontal Bar Chart in "Manguezal" section. -> Interaction: Hover tooltips. -> Justification: A horizontal bar chart powerfully illustrates the stark dependency, creating a high-impact visual that text alone cannot achieve. -> Library: Chart.js.
        - Report Info: Detailed characteristics of each ecosystem (flora, fauna, function). -> Goal: Inform and organize qualitative data. -> Viz: Styled HTML cards with icons (Unicode characters). -> Interaction: None needed, focus on readability. -> Justification: Cards break down complex information into digestible, visually appealing chunks, improving readability and retention.
        - Report Info: Threats (urbanization, pollution) and Conservation Efforts (UCs, restoration). -> Goal: Compare challenges and solutions. -> Viz: Two-column HTML layout. -> Interaction: None, direct comparison. -> Justification: A side-by-side layout provides a clear, balanced perspective on the central conflict affecting the island's ecosystems.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8; /* Warm off-white */
        }
        :root {
            --color-primary: #4A5C43; /* Muted Green */
            --color-secondary: #A49B8D; /* Taupe */
            --color-accent: #D4B79E; /* Light Tan */
            --color-text: #413F3D; /* Dark Brown/Charcoal */
            --color-bg: #FDFBF8;
        }
        .nav-button {
            transition: all 0.3s ease;
            color: var(--color-secondary);
            border-bottom: 2px solid transparent;
        }
        .nav-button.active, .nav-button:hover {
            color: var(--color-primary);
            border-bottom: 2px solid var(--color-primary);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .gemini-button {
            background-color: var(--color-primary);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            transition: background-color 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .gemini-button:hover {
            background-color: #3B4A35;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 24px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
         .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 24px;
            color: #888;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--color-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold" style="color: var(--color-primary);">Ecossistemas da Ilha de Florian√≥polis</h1>
            <p class="mt-2 text-lg" style="color: var(--color-text);">Uma explora√ß√£o interativa da Mata Atl√¢ntica, Restinga e Manguezal.</p>
        </header>

        <nav class="flex flex-wrap justify-center border-b mb-8 gap-x-2 md:gap-x-6 gap-y-2">
            <button class="nav-button active font-medium py-2 px-3" data-target="overview">Vis√£o Geral</button>
            <button class="nav-button font-medium py-2 px-3" data-target="forest">Mata Atl√¢ntica</button>
            <button class="nav-button font-medium py-2 px-3" data-target="restinga">Restinga</button>
            <button class="nav-button font-medium py-2 px-3" data-target="mangrove">Manguezal</button>
            <button class="nav-button font-medium py-2 px-3" data-target="conservation">Amea√ßas & Conserva√ß√£o</button>
            <button class="nav-button font-medium py-2 px-3" data-target="credits">Cr√©ditos</button>
        </nav>

        <main>
            <!-- Vis√£o Geral Section -->
            <section id="overview" class="content-section">
                <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Um Mosaico de Vida</h2>
                    <p style="color: var(--color-text);">
                        A Ilha de Santa Catarina, onde se localiza Florian√≥polis, √© um territ√≥rio privilegiado que abriga um complexo mosaico de ecossistemas interligados. Da exuber√¢ncia das florestas nas encostas √† resili√™ncia das vegeta√ß√µes costeiras, cada ambiente desempenha um papel vital no equil√≠brio ecol√≥gico e na identidade da ilha. Esta se√ß√£o oferece uma vis√£o geral da distribui√ß√£o e import√¢ncia dessas √°reas.
                    </p>
                </div>

                <div class="max-w-4xl mx-auto mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-primary);">V√≠deo Introdut√≥rio</h3>
                         <div class="aspect-w-16 aspect-h-9">
                            <iframe class="w-full h-full rounded-md" src="https://www.youtube.com/embed/L9XBFLVwQaw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-primary);">Uso e Prote√ß√£o do Solo na Ilha</h3>
                        <div class="chart-container">
                            <canvas id="landUseChart"></canvas>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-bold" style="color: var(--color-text);">üå≥ Mata Atl√¢ntica</h3>
                            <p class="mt-1">Cobre as eleva√ß√µes e morros da ilha, sendo um hotspot de biodiversidade, fundamental para a manuten√ß√£o dos recursos h√≠dricos.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-bold" style="color: var(--color-text);">üåø Restinga</h3>
                            <p class="mt-1">Ecossistema costeiro que se desenvolve sobre solos arenosos, atuando como uma barreira natural que protege a ilha da eros√£o marinha.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-bold" style="color: var(--color-text);">ü¶Ä Manguezal</h3>
                            <p class="mt-1">Ber√ß√°rio da vida marinha. Localizado em √°reas estuarinas, √© um dos ecossistemas mais produtivos do planeta, essencial para a pesca.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Mata Atl√¢ntica Section -->
            <section id="forest" class="content-section hidden">
                 <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Mata Atl√¢ntica: O Cora√ß√£o Verde da Ilha</h2>
                     <p style="color: var(--color-text);">
                        A Floresta Ombr√≥fila Densa, forma√ß√£o da Mata Atl√¢ntica presente em Florian√≥polis, √© o ecossistema que cobre os morros e maci√ßos, formando uma paisagem ic√¥nica. Apesar de sua fragmenta√ß√£o, Florian√≥polis se destaca como a segunda capital brasileira com a maior √°rea preservada deste bioma. Essa floresta √© vital para a regula√ß√£o do clima local e, principalmente, para a prote√ß√£o das nascentes e cursos d'√°gua que abastecem a ilha.
                    </p>
                    <div class="mt-6">
                        <button class="gemini-button" data-ecosystem="Mata Atl√¢ntica">‚ú® Gerar Plano de Aula</button>
                    </div>
                </div>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Caracter√≠sticas</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Alta umidade e grande volume de chuvas.</li>
                            <li>Vegeta√ß√£o densa e exuberante com √°rvores de grande porte.</li>
                            <li>Solo rico em mat√©ria org√¢nica.</li>
                            <li>Fundamental para a recarga de aqu√≠feros.</li>
                        </ul>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Flora T√≠pica</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Palmito-ju√ßara (Euterpe edulis)</li>
                            <li>Figueiras (Ficus spp.)</li>
                            <li>Canelas (Ocotea spp.)</li>
                            <li>Orqu√≠deas e brom√©lias diversas.</li>
                        </ul>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Fauna Representativa</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Capivara e Macaco-prego.</li>
                            <li>Tucanos, Gralhas-azuis e Ti√™s-sangue.</li>
                            <li>Cutias e tamandu√°s.</li>
                            <li>In√∫meras esp√©cies de anf√≠bios e insetos.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Restinga Section -->
            <section id="restinga" class="content-section hidden">
                <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Restinga: A Guardi√£ da Costa</h2>
                     <p style="color: var(--color-text);">
                       A restinga √© um ecossistema pioneiro, que se forma sobre os dep√≥sitos de areia ao longo do litoral. Suas plantas s√£o verdadeiras especialistas em sobreviv√™ncia, adaptadas a condi√ß√µes de alta salinidade, ventos constantes e solo pobre em nutrientes. Em Florian√≥polis, a restinga √© fundamental para a fixa√ß√£o das dunas, prevenindo a eros√£o das praias e protegendo as √°reas mais interiores do avan√ßo do mar, especialmente durante ressacas.
                    </p>
                    <div class="mt-6">
                        <button class="gemini-button" data-ecosystem="Restinga">‚ú® Gerar Plano de Aula</button>
                    </div>
                </div>
                 <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Caracter√≠sticas</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Solo arenoso e com alta permeabilidade.</li>
                            <li>Vegeta√ß√£o varia de rasteira a arbustiva.</li>
                            <li>Alta exposi√ß√£o ao sol e ao vento.</li>
                            <li>Fun√ß√£o principal de estabiliza√ß√£o de dunas.</li>
                        </ul>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Flora T√≠pica</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Aroeira-vermelha (Schinus terebinthifolia)</li>
                            <li>Feij√£o-de-praia (Canavalia rosea)</li>
                            <li>Cactos e brom√©lias de ch√£o.</li>
                            <li>Gabiroba (Campomanesia xanthocarpa)</li>
                        </ul>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold" style="color: var(--color-text);">Fauna Representativa</h3>
                        <ul class="mt-2 space-y-2 list-disc list-inside">
                            <li>Lagartinho-da-praia (Liolaemus occipitalis)</li>
                            <li>Coruja-buraqueira.</li>
                            <li>Gamb√°s e pequenos roedores.</li>
                            <li>Aves migrat√≥rias que usam a √°rea para descanso.</li>
                        </ul>
                    </div>
                </div>
                <div class="max-w-4xl mx-auto mt-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-primary);">V√≠deo sobre a Restinga</h3>
                         <div class="aspect-w-16 aspect-h-9">
                            <iframe class="w-full h-full rounded-md" src="https://www.youtube.com/embed/o2gc5249bpw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Manguezal Section -->
            <section id="mangrove" class="content-section hidden">
                <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Manguezal: O Ber√ß√°rio do Oceano</h2>
                     <p style="color: var(--color-text);">
                        Os manguezais s√£o ecossistemas de transi√ß√£o entre os ambientes terrestre e marinho. Desenvolvem-se em estu√°rios e √°reas abrigadas, onde as √°guas dos rios encontram o mar. Suas √°rvores, com ra√≠zes adaptadas, s√£o tolerantes √† salinidade. O manguezal do Itacorubi √© o segundo maior manguezal urbano do Brasil e, como todos os outros, funciona como um filtro biol√≥gico, al√©m de ser o local de reprodu√ß√£o e desenvolvimento para in√∫meras esp√©cies, sustentando a atividade pesqueira.
                    </p>
                    <div class="mt-6">
                        <button class="gemini-button" data-ecosystem="Manguezal">‚ú® Gerar Plano de Aula</button>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                         <div class="bg-white p-6 rounded-lg shadow-md mb-4">
                            <h3 class="text-xl font-bold" style="color: var(--color-text);">Caracter√≠sticas</h3>
                            <ul class="mt-2 space-y-2 list-disc list-inside">
                                <li>Solo lodoso, pobre em oxig√™nio.</li>
                                <li>Encontro de √°gua doce e salgada.</li>
                                <li>Ra√≠zes a√©reas (pneumat√≥foros) para respira√ß√£o.</li>
                                <li>Alta produtividade biol√≥gica.</li>
                                <li>Flora: Mangue-vermelho, Mangue-branco, Mangue-preto.</li>
                                <li>Fauna: Caranguejos, siris, ostras, aves e peixes.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-primary);">Depend√™ncia da Pesca Marinha</h3>
                        <div class="chart-container">
                            <canvas id="fisheriesChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Amea√ßas e Conserva√ß√£o Section -->
            <section id="conservation" class="content-section hidden">
                <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Equil√≠brio Fr√°gil: Amea√ßas e Conserva√ß√£o</h2>
                    <p style="color: var(--color-text);">
                        Apesar de sua riqueza, os ecossistemas de Florian√≥polis enfrentam constantes press√µes. O crescimento urbano desordenado, a polui√ß√£o e a introdu√ß√£o de esp√©cies ex√≥ticas s√£o as principais amea√ßas. Em contrapartida, a sociedade e o poder p√∫blico t√™m se mobilizado atrav√©s da cria√ß√£o de Unidades de Conserva√ß√£o (UCs) e projetos de recupera√ß√£o, buscando garantir a prote√ß√£o e a coexist√™ncia harm√¥nica entre o desenvolvimento e a natureza.
                    </p>
                </div>
                <div class="max-w-4xl mx-auto mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4" style="color: var(--color-primary);">Conserva√ß√£o em A√ß√£o</h3>
                         <div class="aspect-w-16 aspect-h-9">
                            <iframe class="w-full h-full rounded-md" src="https://www.youtube.com/embed/z1h6LDx8xog" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-red-50 p-6 rounded-lg border border-red-200">
                        <h3 class="text-2xl font-bold text-red-800 mb-4">Principais Amea√ßas</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-bold">Expans√£o Urbana e Especula√ß√£o Imobili√°ria</h4>
                                <p>Abertura de estradas e constru√ß√µes em √°reas de encosta (Mata Atl√¢ntica), restingas e aterramento de mangues.</p>
                            </div>
                            <div>
                                <h4 class="font-bold">Polui√ß√£o e Esgoto</h4>
                                <p>Lan√ßamento de efluentes dom√©sticos e industriais sem tratamento, contaminando principalmente os manguezais e a √°gua.</p>
                            </div>
                            <div>
                                <h4 class="font-bold">Esp√©cies Ex√≥ticas Invasoras</h4>
                                <p>Pinus e outras esp√©cies que competem com a vegeta√ß√£o nativa, descaracterizando os ecossistemas, especialmente a restinga.</p>
                            </div>
                             <div>
                                <h4 class="font-bold">Turismo Desordenado</h4>
                                <p>Pisoteio da vegeta√ß√£o de restinga para acesso √†s praias e produ√ß√£o de lixo em √°reas sens√≠veis.</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                        <h3 class="text-2xl font-bold text-green-800 mb-4">A√ß√µes de Conserva√ß√£o</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-bold">Unidades de Conserva√ß√£o (UCs)</h4>
                                <p>Cria√ß√£o de parques e reservas para proteger √°reas significativas, como a Esta√ß√£o Ecol√≥gica de Carij√≥s (manguezal) e o Parque Municipal da Lagoa do Peri (Mata Atl√¢ntica).</p>
                            </div>
                            <div>
                                <h4 class="font-bold">Projetos de Restaura√ß√£o</h4>
                                <p>Iniciativas de plantio de mudas nativas em √°reas de restinga degradadas e remo√ß√£o de esp√©cies ex√≥ticas.</p>
                            </div>
                            <div>
                                <h4 class="font-bold">Fiscaliza√ß√£o Ambiental</h4>
                                <p>√ìrg√£os como a FLORAM atuam para coibir constru√ß√µes irregulares e a degrada√ß√£o ambiental.</p>
                            </div>
                             <div>
                                <h4 class="font-bold">Educa√ß√£o Ambiental</h4>
                                <p>Programas que visam conscientizar a popula√ß√£o e os turistas sobre a import√¢ncia da preserva√ß√£o dos ecossistemas locais.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Cr√©ditos Section -->
            <section id="credits" class="content-section hidden">
                <div class="text-center mb-8 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--color-primary);">Nossos Pesquisadores</h2>
                    <p style="color: var(--color-text);">
                        Este trabalho √© o resultado da dedica√ß√£o e curiosidade dos nossos jovens cientistas.
                    </p>
                </div>
                <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md">
                    <img src="Alunos.jpg"alt="Foto dos alunos: Maria Joana, Benjamim, Mikaela e Guilherme" class="rounded-lg mx-auto mb-4 w-full h-auto object-cover">
                    <p class="text-center text-lg font-medium" style="color: var(--color-text);">
                        Da esquerda para a direita: Maria Joana, Benjamim, Mikaela e Guilherme.
                    </p>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal para a funcionalidade Gemini -->
    <div id="geminiModal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close" id="modalClose">&times;</span>
            <div id="modalBody">
                <!-- Conte√∫do ser√° injetado aqui -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const navButtons = document.querySelectorAll('.nav-button');
            const contentSections = document.querySelectorAll('.content-section');
            const geminiButtons = document.querySelectorAll('.gemini-button');
            const modal = document.getElementById('geminiModal');
            const modalBody = document.getElementById('modalBody');
            const modalClose = document.getElementById('modalClose');

            // Navega√ß√£o por abas
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetId = button.getAttribute('data-target');
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    contentSections.forEach(section => {
                        section.classList.toggle('hidden', section.id !== targetId);
                    });
                });
            });

            // Fun√ß√µes do Modal
            const showModal = () => modal.classList.add('visible');
            const hideModal = () => modal.classList.remove('visible');
            const showLoading = () => {
                modalBody.innerHTML = '<div class="spinner"></div><p class="text-center">A gerar ideias com a Gemini...</p>';
            };
            const displayContent = (htmlContent) => {
                 modalBody.innerHTML = htmlContent;
            };

            modalClose.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    hideModal();
                }
            });

            // L√≥gica da API Gemini
            const callGeminiAPI = async (prompt) => {
                const apiKey = ""; // A chave da API √© gerida pelo ambiente de execu√ß√£o, n√£o precisa de a definir aqui.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const payload = {
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (text) {
                        // Substituir quebras de linha por <br> e formatar t√≠tulos
                        const formattedText = text
                            .replace(/\n/g, '<br>')
                            .replace(/(\d\.\s)/g, '<br><strong>$1</strong>');
                        displayContent(`<div class="prose max-w-none">${formattedText}</div>`);
                    } else {
                        throw new Error("Resposta da API inv√°lida.");
                    }
                } catch (error) {
                    console.error("Erro ao chamar a API Gemini:", error);
                    displayContent('<p class="text-red-500 text-center">Ocorreu um erro ao gerar o conte√∫do. Por favor, tente novamente.</p>');
                }
            };
            
            geminiButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const ecosystem = button.dataset.ecosystem;
                    const prompt = `Aja como um pedagogo criativo. Crie um plano de aula conciso e envolvente para alunos do 5¬∫ ano do ensino fundamental sobre o ecossistema "${ecosystem}" em Florian√≥polis. O plano deve incluir:
                    1. Um objetivo de aprendizagem claro.
                    2. Duas atividades pr√°ticas e divertidas para fazer em sala de aula ou ao ar livre.
                    3. Uma pergunta estimulante para iniciar uma discuss√£o em grupo.
                    Formate a sua resposta de forma clara e organizada.`;
                    
                    showModal();
                    showLoading();
                    callGeminiAPI(prompt);
                });
            });


            // Gr√°ficos Chart.js
            const landUseCtx = document.getElementById('landUseChart').getContext('2d');
            new Chart(landUseCtx, {
                type: 'doughnut',
                data: {
                    labels: ['√Årea de Preserva√ß√£o Permanente (APP)', 'Outras √Åreas'],
                    datasets: [{
                        data: [40, 60],
                        backgroundColor: ['#4A5C43', '#D4B79E'],
                        borderColor: '#FDFBF8',
                        borderWidth: 4,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                             labels: {
                                color: '#413F3D',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });

            const fisheriesCtx = document.getElementById('fisheriesChart').getContext('2d');
            new Chart(fisheriesCtx, {
                type: 'bar',
                data: {
                    labels: ['Recursos Pesqueiros'],
                    datasets: [{
                        label: 'Dependente do Manguezal',
                        data: [95],
                        backgroundColor: '#4A5C43',
                        borderRadius: 4
                    }, {
                        label: 'Outras Fontes',
                        data: [5],
                        backgroundColor: '#A49B8D',
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '%'
                                }
                            }
                        },
                        y: {
                            stacked: true
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                             labels: {
                                color: '#413F3D',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>

</body>
</html>

